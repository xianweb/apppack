<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>APP打包技术 | Electron概要</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/apppack/assets/css/12.styles.14e45a2f.css" as="style"><link rel="preload" href="/apppack/assets/js/app.b5650545.js" as="script"><link rel="preload" href="/apppack/assets/js/11.db65f1df.js" as="script"><link rel="prefetch" href="/apppack/assets/js/0.2e7d2ce9.js"><link rel="prefetch" href="/apppack/assets/js/1.e47463b7.js"><link rel="prefetch" href="/apppack/assets/js/2.4c252028.js"><link rel="prefetch" href="/apppack/assets/js/3.d8000872.js"><link rel="prefetch" href="/apppack/assets/js/4.d79a3119.js"><link rel="prefetch" href="/apppack/assets/js/5.ab3c9604.js"><link rel="prefetch" href="/apppack/assets/js/6.dc718573.js"><link rel="prefetch" href="/apppack/assets/js/7.cbfd3f1a.js"><link rel="prefetch" href="/apppack/assets/js/8.9c9e5afc.js"><link rel="prefetch" href="/apppack/assets/js/9.2028b54c.js"><link rel="prefetch" href="/apppack/assets/js/10.76bbe728.js">
    <link rel="stylesheet" href="/apppack/assets/css/12.styles.14e45a2f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/apppack/" class="home-link router-link-active"><!----><span class="site-name">
      APP打包技术
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>移动APP打包</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>桌面APP打包</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/apppack/page1.html" class="active sidebar-link">Electron概要</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/apppack/page1.html#主进程" class="sidebar-link">主进程</a></li><li class="sidebar-sub-header"><a href="/apppack/page1.html#渲染进程" class="sidebar-link">渲染进程</a></li><li class="sidebar-sub-header"><a href="/apppack/page1.html#主进程与渲染进程的区别" class="sidebar-link">主进程与渲染进程的区别</a></li><li class="sidebar-sub-header"><a href="/apppack/page1.html#打造你第一个-electron-应用" class="sidebar-link">打造你第一个 Electron 应用</a></li><li class="sidebar-sub-header"><a href="/apppack/page1.html#运行你的应用" class="sidebar-link">运行你的应用</a></li></ul></li><li><a href="/apppack/page2.html" class="sidebar-link">Electron应用打包</a></li><li><a href="/apppack/page3.html" class="sidebar-link">Electron BrowserWindow 模块</a></li><li><a href="/apppack/page4.html" class="sidebar-link">Electron ipcMain 模块</a></li><li><a href="/apppack/page5.html" class="sidebar-link">Electron ipcRenderer 模块</a></li><li><a href="/apppack/page6.html" class="sidebar-link">Electron menu 模块</a></li><li><a href="/apppack/page7.html" class="sidebar-link">Electron Tray 模块</a></li><li><a href="/apppack/page8.html" class="sidebar-link">Electron DOM File对象</a></li><li><a href="/apppack/page9.html" class="sidebar-link">electron-packager 打包</a></li><li><a href="/apppack/page10.html" class="sidebar-link">NSIS 打包</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="electron概要"><a href="#electron概要" aria-hidden="true" class="header-anchor">#</a> Electron概要</h1><p><code>Electron</code> 可以让你使用纯 <code>JavaScript</code> 调用丰富的原生 <code>APIs</code> 来创造桌面应用。你可以把它看作是专注于<strong>桌面应用</strong>而不是 web 服务器的，<code>io.js</code> 的一个变体。</p><p>这不意味着 <code>Electron</code> 是绑定了 GUI 库的 <code>JavaScript</code>。相反，<code>Electron</code> 使用 <code>web</code> 页面作为它的 <code>GUI</code>，所以你能把它看作成一个被 <code>JavaScript</code> 控制的，精简版的 <code>Chromium</code> 浏览器。</p><h2 id="主进程"><a href="#主进程" aria-hidden="true" class="header-anchor">#</a> 主进程</h2><p>在 <code>Electron</code> 里，运行 <code>package.json</code> 里 <code>main</code> 脚本的进程被称为<strong>主进程</strong>。在主进程运行的脚本可以以创建 <code>web</code> 页面的形式展示 <code>GUI</code>。</p><h2 id="渲染进程"><a href="#渲染进程" aria-hidden="true" class="header-anchor">#</a> 渲染进程</h2><p>由于 <code>Electron</code> 使用 <code>Chromium</code> 来展示页面，所以 <code>Chromium</code> 的多进程结构也被充分利用。每个 <code>Electron</code>的页面都在运行着自己的进程，这样的进程我们称之为<strong>渲染进程</strong>。</p><p>在一般浏览器中，网页通常会在<strong>沙盒环境</strong>下运行，并且不允许访问<strong>原生资源</strong>。然而，<code>Electron</code> 用户拥有在网页中调用 <code>io.js</code> 的 <code>APIs</code> 的能力，可以与<strong>底层操作系统</strong>直接交互。</p><h2 id="主进程与渲染进程的区别"><a href="#主进程与渲染进程的区别" aria-hidden="true" class="header-anchor">#</a> 主进程与渲染进程的区别</h2><p>主进程使用 <code>BrowserWindow</code> 实例创建网页。每个 <code>BrowserWindow</code> 实例都在自己的<strong>渲染进程</strong>里运行着一个网页。当一个 <code>BrowserWindow</code> 实例被销毁后，相应的<strong>渲染进程</strong>也会被终止。</p><p><strong>主进程</strong>管理<strong>所有页面</strong>和与之<strong>对应的渲染进程</strong>。<strong>每个渲染进程都是相互独立的</strong>，并且只关心他们自己的网页。</p><p>由于在网页里管理原生 <code>GUI</code> 资源是非常危险而且容易造成资源泄露，所以在网页面调用 <code>GUI</code> 相关的 <code>APIs</code> 是<strong>不被允许的</strong>。如果你想在网页里使用 <code>GUI</code> 操作，其对应的<strong>渲染进程</strong>必须与<strong>主进程</strong>进行通讯，请求主进程进行相关的 <code>GUI</code> 操作。</p><p>在 <code>Electron</code>，我们提供用于在<strong>主进程</strong>与<strong>渲染进程</strong>之间通讯的 <code>ipc</code> 模块。并且也有一个<strong>远程进程</strong>调用风格的通讯模块 <code>remote</code>。</p><h2 id="打造你第一个-electron-应用"><a href="#打造你第一个-electron-应用" aria-hidden="true" class="header-anchor">#</a> 打造你第一个 Electron 应用</h2><p>大体上，一个 Electron 应用的目录结构如下：</p><pre class="language-text"><code>your-app/
├── package.json
├── main.js
└── index.html
</code></pre><p><code>package.json</code>的格式和 <code>Node</code> 的完全一致，并且那个被 <code>main</code> 字段声明的脚本文件是你的应用的启动脚本，它运行在主进程上。你应用里的 <code>package.json</code> 看起来应该像：</p><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span>    <span class="token operator">:</span> <span class="token string">&quot;your-app&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;0.1.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span>    <span class="token operator">:</span> <span class="token string">&quot;main.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="warning custom-block"><p class="custom-block-title">注意</p><p>注意：如果 <code>main</code> 字段没有在 <code>package.json</code> 声明，<code>Electron</code>会优先加载 <code>index.js</code>。</p></div><p><code>main.js</code> 应该用于创建窗口和处理系统时间，一个典型的例子如下：</p><pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>app<span class="token punctuation">;</span>  <span class="token comment">// 控制应用生命周期的模块。</span>

<span class="token keyword">var</span> BrowserWindow <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BrowserWindow<span class="token punctuation">;</span>  <span class="token comment">// 创建原生浏览器窗口的模块</span>

<span class="token comment">// 保持一个对于 window 对象的全局引用，不然，当 JavaScript 被 GC，</span>
<span class="token comment">// window 会被自动地关闭</span>
<span class="token keyword">var</span> mainWindow <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token comment">// 当所有窗口被关闭了，退出。</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'window-all-closed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在 OS X 上，通常用户在明确地按下 Cmd + Q 之前</span>
  <span class="token comment">// 应用会保持活动状态</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>platform <span class="token operator">!=</span> <span class="token string">'darwin'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 当 Electron 完成了初始化并且准备创建浏览器窗口的时候</span>
<span class="token comment">// 这个方法就被调用</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建浏览器窗口。</span>
  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>width<span class="token punctuation">:</span> <span class="token number">800</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">600</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 加载应用的 index.html</span>
  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">'file://'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">'/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 打开开发工具</span>
  mainWindow<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 当 window 被关闭，这个事件会被发出</span>
  mainWindow<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 取消引用 window 对象，如果你的应用支持多窗口的话，</span>
    <span class="token comment">// 通常会把多个 window 对象存放在一个数组里面，</span>
    <span class="token comment">// 但这次不是。</span>
    mainWindow <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>最后，你想展示的 <code>index.html</code></p><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Hello World!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello World!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    We are using io.js <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>version<span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    and Electron <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>versions<span class="token punctuation">[</span><span class="token string">'electron'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>.
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><h2 id="运行你的应用"><a href="#运行你的应用" aria-hidden="true" class="header-anchor">#</a> 运行你的应用</h2><p>一旦你创建了最初的 <code>main.js</code>， <code>index.html</code> 和 <code>package.json</code> 这几个文件，你可能会想尝试在<strong>本地运行并测试</strong>，看看是不是和期望的那样正常运行。</p><h3 id="electron-prebuild"><a href="#electron-prebuild" aria-hidden="true" class="header-anchor">#</a> electron-prebuild</h3><p>如果你已经用 npm 全局安装了 <code>electron-prebuilt</code>，你只需要按照如下方式直接运行你的应用：</p><pre class="language-text"><code>electron .
</code></pre><p>如果你是局部安装，那运行：</p><pre class="language-text"><code>./node_modules/.bin/electron .
</code></pre><h3 id="手工下载-electron-二进制文件"><a href="#手工下载-electron-二进制文件" aria-hidden="true" class="header-anchor">#</a> 手工下载 Electron 二进制文件</h3><p>如果你手工下载了 <code>Electron</code> 的二进制文件，你也可以直接使用其中的<strong>二进制文件</strong>直接运行你的应用。</p><h4 id="windows"><a href="#windows" aria-hidden="true" class="header-anchor">#</a> Windows</h4><pre class="language-text"><code>$ .\electron\electron.exe your-app\
</code></pre><h4 id="linux"><a href="#linux" aria-hidden="true" class="header-anchor">#</a> Linux</h4><pre class="language-text"><code>$ ./electron/electron your-app/
</code></pre><h4 id="os-x"><a href="#os-x" aria-hidden="true" class="header-anchor">#</a> OS X</h4><pre class="language-text"><code>$ ./Electron.app/Contents/MacOS/Electron your-app/
</code></pre><p><code>Electron.app</code> 里面是 <code>Electron</code> 发布包，你可以在<a href="https://github.com/electron/electron/releases" target="_blank" rel="noopener noreferrer">这里</a>下载到。</p></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/apppack/page11.html" class="prev">
          HBuilder打包App
        </a></span><span class="next"><a href="/apppack/page2.html">
          Electron应用打包
        </a> →
      </span></p></div></div></div></div>
    <script src="/apppack/assets/js/11.db65f1df.js" defer></script><script src="/apppack/assets/js/app.b5650545.js" defer></script>
  </body>
</html>
